{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-lg-8">
    <h2>{{ event.title }}</h2>
    <div class="text-muted mb-2">
      <span
        class="js-event-time"
        data-event-utc="{{ event.start_time.isoformat(timespec='seconds') }}Z"
      >
        <span class="fw-semibold">Starts:</span>
        <span class="js-event-absolute">{{ event.start_time.strftime('%Y-%m-%d %H:%M') }}</span>
        <span class="js-event-relative ms-2" data-placeholder="Calculating...">Calculating...</span>
      </span>
      <div class="mt-2">{{ event.location or 'Location TBD' }}</div>
      {% if event.end_time %}
      <div>Duration: {{ event.start_time|duration(event.end_time) }}</div>
      {% endif %}
    </div>
    {% if event.channel and not (not event.is_private and event.channel.visibility == 'private') %}
    <div class="mb-3">
      {% if event.channel.visibility == 'private' %}
      {% set channel_url = request.url_for('channel_page_private', slug=event.channel.slug) %}
      <span class="badge bg-dark me-2">Private Channel</span>
      {% else %}
      {% set channel_url = request.url_for('channel_page', slug=event.channel.slug) %}
      <span class="badge bg-primary me-2">Public Channel</span>
      {% endif %}
      <a href="{{ channel_url }}" class="fw-semibold text-decoration-none">{{ event.channel.name }}</a>
    </div>
    {% endif %}
    {% if event.description %}
    <div class="mb-4 markdown-content">{{ event.description | markdown | safe }}</div>
    {% else %}
    <p class="text-muted">No description provided.</p>
    {% endif %}
    <div class="mb-4">
      <a class="btn btn-success" href="/e/{{ event.id }}/rsvp">Submit RSVP</a>
    </div>
    <h3 class="h5">Attendees</h3>
    {% if rsvps %}
      <ul class="list-group">
        {% for rsvp in rsvps %}
        <li class="list-group-item">
          <strong>{{ rsvp.name }}</strong>
          <span class="badge bg-secondary ms-2 text-uppercase">{{ rsvp.status }}</span>
          {% if rsvp.pronouns %}<span class="text-muted ms-2">({{ rsvp.pronouns }})</span>{% endif %}
          <div class="small text-muted">Guests: {{ rsvp.guest_count }}{% if rsvp.notes %} Â· Notes: {{ rsvp.notes }}{% endif %}</div>
        </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-muted">No RSVPs yet. Be the first!</p>
    {% endif %}
  </div>
</div>
{% endblock %}
