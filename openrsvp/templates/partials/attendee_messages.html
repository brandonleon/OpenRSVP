<div class="mt-4" id="attendee-messages" hx-target="this" hx-swap="outerHTML">
  <h3 class="h6 text-uppercase text-muted mb-2">Messages</h3>
  {% if attendee_message_flash %}
  <div class="alert {{ attendee_message_class or 'alert-info' }} small mb-3">
    {{ attendee_message_flash }}
  </div>
  {% endif %}
  <form
    method="post"
    action="/e/{{ event.id }}/rsvp/{{ rsvp.rsvp_token }}/messages"
    class="mb-3"
    hx-post="/e/{{ event.id }}/rsvp/{{ rsvp.rsvp_token }}/messages"
    hx-target="#attendee-messages"
    hx-swap="outerHTML"
  >
    <label class="form-label small">Send a message to the organizer</label>
    <div class="d-flex flex-column flex-md-row gap-2">
      <textarea name="content" class="form-control" rows="2" placeholder="Visible to the organizer" required></textarea>
      <button class="btn btn-outline-primary" type="submit">Send</button>
    </div>
  </form>
  {% set attendee_feed = attendee_messages or [] %}
  {% if attendee_feed %}
  <div class="list-group list-group-flush">
    {% for message in attendee_feed %}
    <div class="list-group-item px-0">
      <div class="d-flex justify-content-between align-items-start gap-2">
        <div>
          <div class="fw-semibold">{{ message.content }}</div>
          <div class="small text-muted">{{ message.created_at|relative_time }}</div>
        </div>
        <span class="badge bg-light text-dark text-uppercase">{{ message.message_type }}</span>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-muted small mb-0">No messages yet.</p>
  {% endif %}
</div>
